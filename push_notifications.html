
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Enabling SmartAlerts™ Notifications &mdash; Socialize iOS SDK 1.6.5 documentation</title>
    
    <link rel="stylesheet" href="static/nature.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.6.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="shortcut icon" href="static/favicon.ico"/>
    <link rel="top" title="Socialize iOS SDK 1.6.5 documentation" href="index.html" />
    <link rel="next" title="Socialize Comments" href="comments.html" />
    <link rel="prev" title="Twitter Integration" href="twitter.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="comments.html" title="Socialize Comments"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="twitter.html" title="Twitter Integration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Socialize iOS SDK 1.6.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <script type="text/javascript" charset="utf-8">
  var is_ssl = ("https:" == document.location.protocol);
  var asset_host = is_ssl ? "https://s3.amazonaws.com/getsatisfaction.com/" : "http://s3.amazonaws.com/getsatisfaction.com/";
  document.write(unescape("%3Cscript src='" + asset_host + "javascripts/feedback-v2.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript" charset="utf-8">
  var feedback_widget_options = {};

  feedback_widget_options.display = "overlay";
  feedback_widget_options.company = "socialize";
  feedback_widget_options.placement = "right";
  feedback_widget_options.color = "#222";
  feedback_widget_options.style = "idea";
  feedback_widget_options.product = "socialize_ios_sdk";
  feedback_widget_options.tag = "Feedback";

  feedback_widget_options.limit = "3";

  GSFN.feedback_widget.prototype.local_base_url = "http://support.getsocialize.com";
  GSFN.feedback_widget.prototype.local_ssl_base_url = "http://support.getsocialize.com";

  var feedback_widget = new GSFN.feedback_widget(feedback_widget_options);
</script><div class="section" id="enabling-smartalerts-notifications">
<h1>Enabling SmartAlerts™ Notifications<a class="headerlink" href="#enabling-smartalerts-notifications" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In v1.3 of Socialize we introduced push notifications. This provides your app with a simple and effective way to bring users back into the “viral loop” of the app.</p>
<img alt="images/apns_screenshot.png" src="images/apns_screenshot.png" />
<div class="section" id="smartalerts-in-comment-threads">
<h3>SmartAlerts™ in Comment Threads<a class="headerlink" href="#smartalerts-in-comment-threads" title="Permalink to this headline">¶</a></h3>
<p>when a user posts a comment they can elect to subscribe to updates for that topic.</p>
<p>When another user then posts a comment, the original user will receive a push notification to their device bringing them back into the app.</p>
</div>
</div>
<div class="section" id="step-1-setup-smartalerts-on-the-app-dashboard">
<h2>Step 1: Setup SmartAlerts™ on the App Dashboard<a class="headerlink" href="#step-1-setup-smartalerts-on-the-app-dashboard" title="Permalink to this headline">¶</a></h2>
<p>for Push Notifications to work they must be enabled on a compatible plan at <a class="reference external" href="http://getsocialize.com/apps">http://getsocialize.com/apps</a></p>
<p>Select your app and click “SmartAlerts Settings”</p>
<img alt="images/notification_web_settings.png" src="images/notification_web_settings.png" />
<p>Then turn on enabled:</p>
<img alt="images/notification_web_switch.png" src="images/notification_web_switch.png" />
</div>
<div class="section" id="step-2-configuring-your-apple-app-id">
<h2>Step 2: Configuring Your Apple App ID<a class="headerlink" href="#step-2-configuring-your-apple-app-id" title="Permalink to this headline">¶</a></h2>
<p>Find your App ID in the <a class="reference external" href="https://developer.apple.com/ios/manage/bundles/index.action">Apple&#8217;s developer portal</a> here: <a class="reference external" href="https://developer.apple.com/ios/manage/bundles/index.action">https://developer.apple.com/ios/manage/bundles/index.action</a>&gt; . Then click &#8216;Configure&#8217; on the right-hand side.</p>
<img alt="images/appid_listing.png" src="images/appid_listing.png" />
<p>Make sure &#8220;Enable for Apple Push Notification service&#8221; is checked.</p>
</div>
<div class="section" id="step-3-keys-certificates-for-your-app-id-for-apns">
<h2>Step 3: Keys/Certificates for your App ID for APNS<a class="headerlink" href="#step-3-keys-certificates-for-your-app-id-for-apns" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Click the &#8216;configure&#8217; button for your &#8216;Production Push SSL Certificate&#8217; on the right hand side.</li>
</ul>
<p>Follow the directions given to you by Apple <strong>very carefully</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>We currently don’t support development push certificates</li>
<li>You don’t have to use your primary Keychain key as the identifier, nor does it have to connect to your developer account.   You can make a new keychain in Keychain Access, and use that to handle the Certificate Signing Request. This can be especially useful if you need to share this between multiple developers.</li>
</ul>
</div>
<img alt="images/add_certificates.png" src="images/add_certificates.png" />
<ul class="simple">
<li>Open the certificate after completing the steps and downloading the certificate(.cer) by double clicking the file.  This should result in the &#8216;Keychain Access&#8217; application opening.</li>
<li><strong>Re-create your distribution provisioning profile, download and re-install the profile</strong>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is important to note that just creating or updating your Apple Push Notification Service certificate will not update your provisioning profile.  Therefore make sure to re-create your distribution
provisioning profile for your changes to take effect.</p>
</div>
</div>
<div class="section" id="step-4-exporting-your-p12-key-certificate-pair-from-the-keychain-access-tool">
<h2>Step 4: Exporting your .p12 (key/certificate pair) from the Keychain Access tool.<a class="headerlink" href="#step-4-exporting-your-p12-key-certificate-pair-from-the-keychain-access-tool" title="Permalink to this headline">¶</a></h2>
<p>Double-clicking the certificate(.cer) should automatically open the &#8216;Keychain Access&#8217; tool.</p>
<ul class="simple">
<li>Find the &#8216;My Certificates&#8217; category on the left hand side of the &#8216;Keychain Access&#8217; tool.</li>
<li>Right-click on the &#8216;Apple Production iOS Push Services&#8217; and export the key/certificate pair in the p12 (Personal Information Exchange) format.</li>
<li>Save this file without a password to your desktop.</li>
</ul>
<img alt="images/export_p12.png" src="images/export_p12.png" />
</div>
<div class="section" id="step-5-uploading-your-p12-to-the-socialize-developer-portal">
<h2>Step 5: Uploading your .p12 to the Socialize Developer Portal<a class="headerlink" href="#step-5-uploading-your-p12-to-the-socialize-developer-portal" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Go to your SmartAlert&#8217;s setup dashboard and upload the p12 from the previous step.  You can find your application dashboard here: <a class="reference external" href="http://www.getsocialize.com/apps">http://www.getsocialize.com/apps</a></li>
</ul>
<p>If you&#8217;ve added a password to your p12 make sure to put that in.</p>
<img alt="images/notification_p12_upload.png" src="images/notification_p12_upload.png" />
</div>
<div class="section" id="step-6-configuring-notifications-in-your-app">
<h2>Step 6: Configuring Notifications in Your App<a class="headerlink" href="#step-6-configuring-notifications-in-your-app" title="Permalink to this headline">¶</a></h2>
<p>To configure your app you&#8217;ll need to register for notifications, handle the notification response and define an entity loader so we display users your content.</p>
<div class="section" id="register-for-notifications">
<h3>Register for Notifications<a class="headerlink" href="#register-for-notifications" title="Permalink to this headline">¶</a></h3>
<p>Add the following line to your application delegate:</p>
<script src="https://gist.github.com/1671602.js?file=registerForNotifications.m"></script></div>
<div class="section" id="register-the-device-token">
<h3>Register the Device Token<a class="headerlink" href="#register-the-device-token" title="Permalink to this headline">¶</a></h3>
<p>To register your app&#8217;s device token add the following lines to your application&#8217;s delegate</p>
<script src="https://gist.github.com/2287010.js?file=appDelegate.m"></script></div>
<div class="section" id="handle-notifications">
<h3>Handle Notifications<a class="headerlink" href="#handle-notifications" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Add the lines below to allow Socialize to handle the notification.</li>
</ul>
<script src="https://gist.github.com/1566706.js?file=MyAppDelegate.m"></script><div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Socialize will not currently do any foreground handling of notifications. If a notification is received while the Application is in the foreground, it will be ignored.</li>
<li>Our method call will let you know if the notification was a Socialize notification. This allows you to use the logic below to also handle notifications of your own, if you need to.</li>
</ul>
</div>
</div>
<div class="section" id="defining-an-entity-loader">
<h3>Defining an Entity Loader<a class="headerlink" href="#defining-an-entity-loader" title="Permalink to this headline">¶</a></h3>
<p>For Smart Alerts to work correctly, you must define an entity loader.</p>
<p>Defining an Entity Loader allows Socialize&#8217;s UI objects to link back to your
application&#8217;s objects.</p>
<p>Copy the lines below to add an entity loader</p>
<script src="https://gist.github.com/1667068.js?file=entityLoader.m"></script><img alt="images/entity_loader.png" src="images/entity_loader.png" />
<p>For some applications, it might happen that an entities are not always
available. Socialize provides the ability to selectively disable loading for a
given entity. Should you find you need this, you can do this by defining a &#8220;Can
Load Entity&#8221; block, as follows</p>
<script src="https://gist.github.com/1667068.js?file=canLoadEntity.m"></script></div>
</div>
<div class="section" id="testing-smartalerts">
<h2>Testing SmartAlerts™<a class="headerlink" href="#testing-smartalerts" title="Permalink to this headline">¶</a></h2>
<p>In order to test that SmartAlerts™ are working correctly you&#8217;ll want to first to get your app compiled and installed on a physical device and working
on the simulator as well.</p>
<ol class="arabic simple">
<li>Open apps on both the simulator and the physical device.</li>
<li>From the physical device leave a comment on an entity.  Make sure you to subscribe to entity when you leave a comment.  You should now be subscribed to the entity and will receive notifications when someone else leaves a comment.</li>
<li>On the simulator add a comment to the same the entity from which you did on the physical device.</li>
<li>Notifications are sent out asynchronously in a queue.  It may take 2-3 minutes to receive your notification.</li>
</ol>
<img alt="images/subscribe_button.png" src="images/subscribe_button.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The subscribe button will only show on an actual device. If you do not see the button on the device, please refer to the Troubleshooting section below.</p>
</div>
</div>
<div class="section" id="sending-targeted-smartalerts">
<h2>Sending Targeted SmartAlerts™<a class="headerlink" href="#sending-targeted-smartalerts" title="Permalink to this headline">¶</a></h2>
<p>If you would like to send a target alert your users, you can do so. Simply
click &#8220;Send SmartAlert&#8221; from the developer dashboard. You can direct the user
to either a specific entity or a URL of your choosing. Directing to an entity
will trigger your entity loader. Directing to a URL will send the user to a web
view to a URL of your choosing. You can either target all of your users or specify
a comma-separated list of user ids.</p>
<img alt="images/send_targeted_smartalert.png" src="images/send_targeted_smartalert.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Socialize v1.6 or later is required to receive target SmartAlerts</p>
</div>
</div>
<div class="section" id="troubleshooting-notifications">
<h2>Troubleshooting Notifications<a class="headerlink" href="#troubleshooting-notifications" title="Permalink to this headline">¶</a></h2>
<p>If you are not receiving notifications, there are some simple ways to
troubleshoot problems.  We also have a vibrant developer community and support
here: <a class="reference external" href="http://support.getsocialize.com">http://support.getsocialize.com</a> support who can help.</p>
<p>Additionally, here some common errors you might encounter:</p>
<div class="section" id="i-don-t-see-the-notifications-button">
<h3>I Don&#8217;t See the Notifications Button<a class="headerlink" href="#i-don-t-see-the-notifications-button" title="Permalink to this headline">¶</a></h3>
<p>The notifications button will only appear if a valid push token has been
registered with Socialize using [Socialize registerDeviceToken:]. This means
the buttons will never show on the iOS simulator.</p>
<p>If you do not see the buttons on the actual device, you might try making sure there
are no errors with registration process, as described in the next section.</p>
</div>
<div class="section" id="logging-errors-from-notifications-registrations">
<h3>Logging Errors from Notifications Registrations<a class="headerlink" href="#logging-errors-from-notifications-registrations" title="Permalink to this headline">¶</a></h3>
<p>You can implement the notifications delegate method which callbacks if any error occurs during registration.  This should log
the value of the error to your console.</p>
<script src="https://gist.github.com/1671602.js?file=HandleError.m"></script></div>
<div class="section" id="i-keep-getting-the-error-no-valid-aps-environment-entitlement-string-found-for-application">
<h3>I Keep Getting the Error &#8220;no valid &#8216;aps-environment&#8217; entitlement string found for application&#8221;<a class="headerlink" href="#i-keep-getting-the-error-no-valid-aps-environment-entitlement-string-found-for-application" title="Permalink to this headline">¶</a></h3>
<p>This typically means you didn&#8217;t re-create and download the provisioning profile after you enabled pushed notifications.
You can re-create your distribution profile here: <a class="reference external" href="https://developer.apple.com/ios/manage/provisioningprofiles/viewDistributionProfiles.action">https://developer.apple.com/ios/manage/provisioningprofiles/viewDistributionProfiles.action</a>.  You&#8217;ll also want to remove any
other versions of provisioning file which exist on your phone.</p>
</div>
<div class="section" id="everything-looks-ok-but-i-am-still-not-receiving-notifications">
<h3>Everything looks ok, but I am still not receiving notifications<a class="headerlink" href="#everything-looks-ok-but-i-am-still-not-receiving-notifications" title="Permalink to this headline">¶</a></h3>
<p>You can try sending a push directly to your device. You can open the device logs from Xcode
by attaching your device, selecting Window -&gt; Organizer, choosing your device, and selecting
&#8220;Console&#8221;. The message is</p>
<pre>Mar 28 12:16:57 AppName[3354] <Warning>: Socialize: device token FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF successfully registered with server</pre><p>You can then send a notification from the web interface, in the &#8220;View Debugger&#8221; section of the
web interface.</p>
<img alt="images/send_to_device.png" src="images/send_to_device.png" />
<p>One possibility is that Socialize has received a development push token.
Development tokens will currently prevent pushes being sent to real devices.
Until Socialize automatically clears these on error, you should verify that you
do not send development tokens to Socialize using [Socialize
registerDeviceToken:]</p>
<p>As a precaution, you might wrap the registration call as follows:</p>
<script src="https://gist.github.com/1879369.js?file=gistfile1.m"></script><p>This is only a problem if you already have separate push configurations and certificates
for development and distribution. Socialize itself does not support development push.</p>
<p>Please go to support.getsocialize.com for additional support.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="action_bar.html">Socialize Action Bar</a></li>
<li class="toctree-l1"><a class="reference internal" href="twitter.html">Twitter Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Enabling SmartAlerts™ Notifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-1-setup-smartalerts-on-the-app-dashboard">Step 1: Setup SmartAlerts™ on the App Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-configuring-your-apple-app-id">Step 2: Configuring Your Apple App ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-keys-certificates-for-your-app-id-for-apns">Step 3: Keys/Certificates for your App ID for APNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-exporting-your-p12-key-certificate-pair-from-the-keychain-access-tool">Step 4: Exporting your .p12 (key/certificate pair) from the Keychain Access tool.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-uploading-your-p12-to-the-socialize-developer-portal">Step 5: Uploading your .p12 to the Socialize Developer Portal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-6-configuring-notifications-in-your-app">Step 6: Configuring Notifications in Your App</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-smartalerts">Testing SmartAlerts™</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sending-targeted-smartalerts">Sending Targeted SmartAlerts™</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting-notifications">Troubleshooting Notifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="comments.html">Socialize Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_advanced.html">Advanced UI Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk_user_guide.html">SDK User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="sdk_pro_tips.html">SDK Pro Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="comments.html" title="Socialize Comments"
             >next</a></li>
        <li class="right" >
          <a href="twitter.html" title="Twitter Integration"
             >previous</a> |</li>
        <li><a href="index.html">Socialize iOS SDK 1.6.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Socialize Inc.
    </div>
  </body>
</html>